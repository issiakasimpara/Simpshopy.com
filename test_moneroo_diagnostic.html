<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic API Moneroo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 3px; white-space: pre-wrap; font-size: 12px; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>üîç Diagnostic API Moneroo</h1>
    
    <div class="test-section">
        <h3>1. Test de Connectivit√© de Base</h3>
        <button onclick="testBasicConnectivity()">Tester connectivit√© de base</button>
        <div id="connectivityResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>2. Test de l'API Key</h3>
        <button onclick="testApiKey()">Tester la cl√© API</button>
        <div id="apiKeyResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>3. Test des Endpoints de Base</h3>
        <button onclick="testBaseEndpoints()">Tester endpoints de base</button>
        <div id="baseEndpointsResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>4. Recherche de Documentation</h3>
        <button onclick="searchDocumentation()">Rechercher documentation</button>
        <div id="documentationResult" class="result"></div>
    </div>

    <script>
        const API_KEY = 'pvk_gh2952|01K13M0N3BH14WR6V634FC14TD';
        
        async function testBasicConnectivity() {
            const resultDiv = document.getElementById('connectivityResult');
            resultDiv.textContent = 'Test en cours...';
            
            let results = 'üåê TEST DE CONNECTIVIT√â DE BASE\n\n';
            
            // Test 1: Ping simple
            try {
                const startTime = Date.now();
                const response = await fetch('https://api.moneroo.io/', {
                    method: 'GET',
                    headers: {
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                });
                const endTime = Date.now();
                const pingTime = endTime - startTime;
                
                results += `üì° Ping vers api.moneroo.io:\n`;
                results += `   Status: ${response.status}\n`;
                results += `   Temps: ${pingTime}ms\n`;
                results += `   Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}\n\n`;
                
                if (response.ok) {
                    const data = await response.text();
                    results += `   R√©ponse: ${data.substring(0, 500)}...\n\n`;
                }
            } catch (error) {
                results += `‚ùå Erreur de connectivit√©: ${error.message}\n\n`;
            }
            
            // Test 2: Test avec diff√©rentes m√©thodes
            const methods = ['GET', 'POST', 'OPTIONS'];
            for (const method of methods) {
                try {
                    const response = await fetch('https://api.moneroo.io/', {
                        method: method
                    });
                    results += `üîß ${method} /: ${response.status}\n`;
                } catch (error) {
                    results += `‚ùå ${method} /: Erreur - ${error.message}\n`;
                }
            }
            
            resultDiv.textContent = results;
            resultDiv.className = 'result info';
        }

        async function testApiKey() {
            const resultDiv = document.getElementById('apiKeyResult');
            resultDiv.textContent = 'Test en cours...';
            
            let results = 'üîë TEST DE LA CL√â API\n\n';
            
            // Test 1: Sans cl√© API
            try {
                const response = await fetch('https://api.moneroo.io/payments', {
                    method: 'GET'
                });
                results += `üìã GET /payments (sans cl√©):\n`;
                results += `   Status: ${response.status}\n`;
                const data = await response.text();
                results += `   R√©ponse: ${data}\n\n`;
            } catch (error) {
                results += `‚ùå GET /payments (sans cl√©): ${error.message}\n\n`;
            }
            
            // Test 2: Avec cl√© API
            try {
                const response = await fetch('https://api.moneroo.io/payments', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${API_KEY}`
                    }
                });
                results += `üîë GET /payments (avec cl√©):\n`;
                results += `   Status: ${response.status}\n`;
                const data = await response.text();
                results += `   R√©ponse: ${data}\n\n`;
            } catch (error) {
                results += `‚ùå GET /payments (avec cl√©): ${error.message}\n\n`;
            }
            
            // Test 3: Avec diff√©rents formats de cl√©
            const keyFormats = [
                `Bearer ${API_KEY}`,
                `Basic ${btoa(API_KEY)}`,
                API_KEY,
                `Token ${API_KEY}`
            ];
            
            for (const format of keyFormats) {
                try {
                    const response = await fetch('https://api.moneroo.io/payments', {
                        method: 'GET',
                        headers: {
                            'Authorization': format
                        }
                    });
                    results += `üîë Format "${format.split(' ')[0]}": ${response.status}\n`;
                } catch (error) {
                    results += `‚ùå Format "${format.split(' ')[0]}": Erreur\n`;
                }
            }
            
            resultDiv.textContent = results;
            resultDiv.className = 'result info';
        }

        async function testBaseEndpoints() {
            const resultDiv = document.getElementById('baseEndpointsResult');
            resultDiv.textContent = 'Test en cours...';
            
            const baseEndpoints = [
                '/',
                '/api',
                '/v1',
                '/v2',
                '/docs',
                '/documentation',
                '/health',
                '/status'
            ];
            
            let results = 'üîç TEST DES ENDPOINTS DE BASE\n\n';
            
            for (const endpoint of baseEndpoints) {
                try {
                    const response = await fetch(`https://api.moneroo.io${endpoint}`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `Bearer ${API_KEY}`
                        }
                    });
                    
                    results += `üì° ${endpoint}:\n`;
                    results += `   Status: ${response.status}\n`;
                    
                    if (response.ok) {
                        const data = await response.text();
                        results += `   ‚úÖ SUCC√àS\n`;
                        results += `   R√©ponse: ${data.substring(0, 200)}...\n\n`;
                    } else {
                        const data = await response.text();
                        results += `   ‚ùå √âCHEC\n`;
                        results += `   Erreur: ${data}\n\n`;
                    }
                } catch (error) {
                    results += `üì° ${endpoint}:\n`;
                    results += `   ‚ùå ERREUR: ${error.message}\n\n`;
                }
            }
            
            resultDiv.textContent = results;
            resultDiv.className = 'result info';
        }

        async function searchDocumentation() {
            const resultDiv = document.getElementById('documentationResult');
            resultDiv.textContent = 'Recherche en cours...';
            
            let results = 'üìö RECHERCHE DE DOCUMENTATION\n\n';
            
            // Test des URLs de documentation possibles
            const docUrls = [
                'https://api.moneroo.io/docs',
                'https://api.moneroo.io/documentation',
                'https://api.moneroo.io/api-docs',
                'https://api.moneroo.io/swagger',
                'https://api.moneroo.io/openapi',
                'https://docs.moneroo.io',
                'https://moneroo.io/docs',
                'https://moneroo.io/api'
            ];
            
            for (const url of docUrls) {
                try {
                    const response = await fetch(url, {
                        method: 'GET'
                    });
                    
                    results += `üìñ ${url}:\n`;
                    results += `   Status: ${response.status}\n`;
                    
                    if (response.ok) {
                        results += `   ‚úÖ DOCUMENTATION TROUV√âE !\n`;
                        const data = await response.text();
                        results += `   Contenu: ${data.substring(0, 300)}...\n\n`;
                    } else {
                        results += `   ‚ùå Non trouv√©\n\n`;
                    }
                } catch (error) {
                    results += `üìñ ${url}:\n`;
                    results += `   ‚ùå Erreur: ${error.message}\n\n`;
                }
            }
            
            results += `\nüí° RECOMMANDATIONS:\n`;
            results += `1. V√©rifier si l'API Moneroo existe encore\n`;
            results += `2. Contacter le support Moneroo\n`;
            results += `3. Chercher une documentation alternative\n`;
            results += `4. V√©rifier si l'URL de l'API a chang√©\n`;
            
            resultDiv.textContent = results;
            resultDiv.className = 'result warning';
        }
    </script>
</body>
</html> 